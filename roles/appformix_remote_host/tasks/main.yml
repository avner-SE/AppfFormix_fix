---
- name: Register remote host with AppFormix Controller
  script: >
      configure_host.py --token {{ auth_token }} --host {{ item }} --url {{ post_url }} --task_url {{ task_url }} --source {{ appformix_bare_host_source }} --snmp_ip {{ hostvars[item]['snmp_ip'] | default("not_configured") }} --snmp_user {{ hostvars[item]['snmp_user'] | default("not_configured") }} --snmp_pwd {{ hostvars[item]['snmp_pwd'] | default("not_configured") }} --snmp_community {{ hostvars[item]['snmp_community'] | default("not_configured") }} --snmp_protocol {{ hostvars[item]['snmp_protocol'] | default("not_configured") }} --snmp_level {{ hostvars[item]['snmp_level'] | default("not_configured") }} --snmp_version {{ hostvars[item]['snmp_version'] | default("not_configured") }} --snmp_priv {{ hostvars[item]['snmp_priv'] | default("not_configured") }} --snmp_priv_protocol {{ hostvars[item]['snmp_priv_protocol'] | default("not_configured") }} --ipmi_ip {{ hostvars[item]['ipmi_ip'] | default("not_configured") }} --ipmi_user {{ hostvars[item]['ipmi_user'] | default("not_configured") }} --ipmi_pwd {{ hostvars[item]['ipmi_pwd'] | default("not_configured") }} --auth_type {{ auth_type }}
  with_items: "{{ groups['remote_host'] | default([]) }}"
